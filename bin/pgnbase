#!/usr/bin/env python
"""This program generates tf.data.Dataset from pgn file"""
print("Import started")
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '3' 
import sys
sys.path.append("/proj")

import argparse
import tensorflow as tf
from dinora import dataset
from dinora import preprocess_pgn
print("Import complete")


if __name__ == "__main__":
    parser = argparse.ArgumentParser(
        description="This program generates tf.data.Dataset from pgn file"
    )
    parser.add_argument('pgn_path')
    parser.add_argument('max_games', type=int)
    parser.add_argument('--output_path', default='dist/pgndataset')

    args = parser.parse_args()

    pgndataset = dataset.create_dataset_from_pgn(args.pgn_path, args.max_games)
    print("Saving started")
    tf.data.experimental.save(pgndataset, args.output_path, 'GZIP')
